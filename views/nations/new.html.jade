extends ../application.html

block headers
  style
    #NSdiv {height: 100%;}
    #NSdiv iframe {height:1000px; width:100%}

  script(type="text/javascript")
    // Fix the damn heights
    $(function() {
      var $NSdiv = $('#NSdiv');
      var $NSiframe = $('#NSiframe');

      if($NSdiv.length) {
        var height = $(window).height() - $NSdiv.offset().top;

        $NSdiv.height(height - 10);
        $NSiframe.height(height - 10);
      }
    })
    

block content
  if offeredNation
    .row
      .span4
        form.form-inline(action="/nations/#{nationSource}", method="post")
          input(type="hidden", name="nation", value="#{offeredNation}")
          .btn-group
            button.btn(
              type="submit",
              name="sent",
            ) Sent TG 
              i.icon-envelope
            button.btn(
              type="submit",
              name="ignored",
            ) Ignored Nation 
              i.icon-trash 
      .span4.well.well-small
        b(style="margin-left:20px") Nation: #{offeredNation}

    .row
      div.span12#NSdiv
        iframe#NSiframe(
          src="http://www.nationstates.net/nation=#{offeredNation}"
        )

  else
    .hero-unit
      p#no-nations No nations available! 
        a(href="/nations/#{nationSource}/new") Check again
        script
          $(function(){
            $timer = $('<div/>');
            $('#no-nations').append($timer)
            $timer.text('Trying again in 5s...');
            time = 5;

            setInterval(function() {
              time = time-1;

              if(time) {
                $timer.text('Trying again in '+time+'s...');
              }
              else {
                document.location.reload();
              }
            },1*1000);
          })
